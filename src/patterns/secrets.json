[
  {
    "id": "aws-access-key",
    "pattern": "AKIA[0-9A-Z]{16}",
    "severity": "critical",
    "description": "AWS Access Key ID found",
    "fix": "Move to environment variables, rotate key, add env files to .gitignore"
  },
  {
    "id": "aws-secret-key",
    "pattern": "aws_secret_access_key\\s*[=:]\\s*[A-Za-z0-9/+=]{40}",
    "severity": "critical",
    "description": "AWS secret key exposed",
    "fix": "Rotate immediately, store in secret manager or env file"
  },
  {
    "id": "aws-env-key",
    "pattern": "AWS_ACCESS_KEY_ID|AWS_SECRET_ACCESS_KEY",
    "severity": "high",
    "description": "AWS credential variable present",
    "fix": "Keep in .env, ensure .env is gitignored"
  },
  {
    "id": "generic-api-key",
    "pattern": "(api_key|apikey|API_KEY)\\s*[=:]\\s*['\\\"]?[A-Za-z0-9\\-_]{12,}['\\\"]?",
    "severity": "high",
    "description": "Generic API key exposed",
    "fix": "Move keys to environment variables or secret manager"
  },
  {
    "id": "private-key-block",
    "pattern": "BEGIN (RSA |EC )?PRIVATE KEY",
    "severity": "critical",
    "description": "Private key material committed",
    "fix": "Remove from git history (git-filter-repo) and rotate keys"
  },
  {
    "id": "database-url",
    "pattern": "DATABASE_URL\\s*=\\s*['\\\"]?.*:\\/\\/[^'\\\"\\s]+['\\\"]?",
    "severity": "high",
    "description": "Database connection string with credentials",
    "fix": "Use env vars and restrict database network access"
  },
  {
    "id": "db-password",
    "pattern": "(DB_PASSWORD|DB_PASS|DATABASE_PASSWORD)\\s*[=:]\\s*['\\\"]?.{6,}['\\\"]?",
    "severity": "high",
    "description": "Database password detected",
    "fix": "Store in secret manager and rotate credentials"
  },
  {
    "id": "oauth-token",
    "pattern": "(OAUTH|access_token|refresh_token)\\s*[=:]\\s*['\\\"]?[A-Za-z0-9\\-_.]{16,}['\\\"]?",
    "severity": "high",
    "description": "OAuth token exposed",
    "fix": "Revoke token and store securely"
  },
  {
    "id": "jwt-secret",
    "pattern": "(JWT_SECRET|TOKEN_SECRET)\\s*[=:]\\s*['\\\"]?.{8,}['\\\"]?",
    "severity": "high",
    "description": "JWT secret exposed",
    "fix": "Rotate secret and move to env"
  },
  {
    "id": "stripe-secret",
    "pattern": "sk_live_[0-9A-Za-z]{24,}",
    "severity": "critical",
    "description": "Stripe secret key exposed",
    "fix": "Rotate Stripe keys and secure storage"
  },
  {
    "id": "stripe-publishable",
    "pattern": "pk_live_[0-9A-Za-z]{24,}",
    "severity": "low",
    "description": "Stripe publishable key present",
    "fix": "Ensure only publishable key is client-side"
  },
  {
    "id": "github-token",
    "pattern": "gh[pousr]_[A-Za-z0-9]{36,}",
    "severity": "critical",
    "description": "GitHub token exposed",
    "fix": "Revoke token via GitHub settings"
  },
  {
    "id": "generic-secret",
    "pattern": "(SECRET|PASSWORD|TOKEN)\\s*[=:]\\s*['\\\"]?.{6,}['\\\"]?",
    "severity": "medium",
    "description": "Possible hardcoded secret",
    "fix": "Verify necessity; move to env if sensitive"
  }
]
